{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="slam-container">
    <div class="control-panel">
        <div class="control-section">
            <h3>Instructions</h3>
            <ul>
                <li>Left click: Add landmark</li>
                <li>Right click: Set robot position</li>
                <li>Drag: Move robot</li>
            </ul>
        </div>

        <div class="control-section">
            <h3>SLAM Parameters</h3>
            <div class="parameter">
                <label for="motion-noise">Motion Noise:</label>
                <input type="range" id="motion-noise" min="0" max="100" value="20">
                <span class="value">20</span>
            </div>
            <div class="parameter">
                <label for="measurement-noise">Measurement Noise:</label>
                <input type="range" id="measurement-noise" min="0" max="100" value="10">
                <span class="value">10</span>
            </div>
            <div class="parameter">
                <label for="num-particles">Number of Particles:</label>
                <input type="range" id="num-particles" min="10" max="1000" value="100">
                <span class="value">100</span>
            </div>
        </div>

        <div class="control-section">
            <h3>Algorithm</h3>
            <select id="slam-algorithm" class="algorithm-select">
                <option value="ekf">EKF SLAM</option>
                <option value="fastslam">FastSLAM</option>
                <option value="graph">Graph SLAM</option>
            </select>
        </div>

        <div class="control-section">
            <h3>Controls</h3>
            <button id="start-slam" class="primary">Start SLAM</button>
            <button id="pause-slam">Pause</button>
            <button id="reset-slam">Reset</button>
            <button id="add-random-landmarks">Add Random Landmarks</button>
            <button id="generate-loop">Generate Loop Path</button>
        </div>

        <div class="control-section">
            <h3>Visualization</h3>
            <div class="checkbox">
                <input type="checkbox" id="show-uncertainty" checked>
                <label for="show-uncertainty">Show Uncertainty</label>
            </div>
            <div class="checkbox">
                <input type="checkbox" id="show-particles" checked>
                <label for="show-particles">Show Particles</label>
            </div>
            <div class="checkbox">
                <input type="checkbox" id="show-measurements" checked>
                <label for="show-measurements">Show Measurements</label>
            </div>
            <div class="checkbox">
                <input type="checkbox" id="show-ground-truth" checked>
                <label for="show-ground-truth">Show Ground Truth</label>
            </div>
        </div>

        <div class="control-section">
            <h3>Statistics</h3>
            <div id="position-error">Position Error: -</div>
            <div id="orientation-error">Orientation Error: -</div>
            <div id="landmark-error">Landmark Error: -</div>
            <div id="computation-time">Time: -</div>
        </div>
    </div>

    <div class="visualization">
        <canvas id="slam-canvas"></canvas>
    </div>
</div>

<style>
.slam-container {
    display: flex;
    height: calc(100vh - 100px);
    gap: 20px;
    padding: 20px;
    background: #f5f5f5;
}

.control-panel {
    width: 300px;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    overflow-y: auto;
}

.visualization {
    flex-grow: 1;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    overflow: hidden;
}

#slam-canvas {
    width: 100%;
    height: 100%;
}

.control-section {
    margin-bottom: 20px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
}

.control-section:last-child {
    border-bottom: none;
}

.control-section h3 {
    margin: 0 0 10px 0;
    color: #333;
}

.parameter {
    margin: 10px 0;
}

.parameter label {
    display: block;
    margin-bottom: 5px;
}

.parameter input[type="range"] {
    width: 100%;
}

.parameter .value {
    float: right;
    color: #666;
}

.algorithm-select {
    width: 100%;
    padding: 8px;
    margin: 5px 0;
    border: 1px solid #ddd;
    border-radius: 4px;
    background: white;
}

button {
    width: 100%;
    padding: 8px;
    margin: 5px 0;
    border: none;
    border-radius: 4px;
    background: #e0e0e0;
    cursor: pointer;
    transition: background 0.2s;
}

button:hover {
    background: #d0d0d0;
}

button.primary {
    background: #4CAF50;
    color: white;
}

button.primary:hover {
    background: #45a049;
}

.checkbox {
    margin: 10px 0;
}

#statistics div {
    margin: 5px 0;
    color: #666;
}

ul {
    padding-left: 20px;
    margin: 10px 0;
}

li {
    margin: 5px 0;
    color: #666;
}
</style>

<script src="{% static 'js/slam_buddy.js' %}"></script>

<script>
// Update range input values
document.querySelectorAll('input[type="range"]').forEach(input => {
    const valueSpan = input.parentElement.querySelector('.value');
    input.addEventListener('input', () => {
        valueSpan.textContent = input.value;
    });
});
</script>
{% endblock %}

